## 2023 杭电多校 4 1011

[Circuit](https://acm.hdu.edu.cn/showproblem.php?pid=7322)

**题目大意**

给定一张无向图，求出图上的最小环长度以及个数。

**题解**



```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
typedef pair<int, int> PII;
const int MAXN = 2e5 + 10, mod = 998244353;
const ll INF = 1e15;
void solve() {
    int n, m;
    cin >> n >> m;
    vector<vector<int>> gra(n, vector<int> (n));
    vector<vector<ll>> dis(n, vector<ll> (n, INF));
    vector<vector<ll>> cnt(n, vector<ll>(n));
    for(int i = 0; i < n; i ++) {
        dis[i][i] = 0;
    }
    for(int i = 0; i < m; i ++) {
        int a, b, w;
        cin >> a >> b >> w;
        a --, b --;
        dis[a][b] = w;
        gra[a][b] = w;
        cnt[a][b] = 1;
    }
    ll mindis = INF, counter = 0;
    for(int k = 0; k < n; k ++) {
        for(int i = 0; i < n; i ++) {
            for(int j = 0; j < n; j ++) {
                if(dis[i][j] > dis[i][k] + dis[k][j]) {
                    cnt[i][j] = cnt[i][k] * cnt[k][j];
                    dis[i][j] = dis[i][k] + dis[k][j];
                } else if(dis[i][j] == dis[i][k] + dis[k][j]) {
                    cnt[i][j] += cnt[i][k] * cnt[k][j];
                }
                cnt[i][j] %= mod;
            }
        }
        for(int i = 0; i < k; i ++) {
            if(gra[k][i]) {
                if(mindis > dis[i][k] + gra[k][i]) {
                    mindis = dis[i][k] + gra[k][i];
                    counter = cnt[i][k];
                } else if(mindis == dis[i][k] + gra[k][i]) {
                    counter += cnt[i][k];
                }
                counter %= mod;
            }
        }
    }
    if(mindis == INF) {
        mindis = counter = -1;
    }
    cout << mindis << " " << counter << '\n';
}
int main() {
    ios::sync_with_stdio(false);
    cin.tie(0);
    int _ = 1;
    cin >> _;
    while(_ --) {
        solve();
    }
}
```